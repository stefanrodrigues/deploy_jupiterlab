schemaVersion: 2.1.0
metadata:
  name: jupyterlab
  version: 0.0.1
  description: A web service template.
  projectType: Python
  language: Python
  provider: Red Hat
  tags: [ 'Python', 'Jupyter']
  displayName: Simple Python Test
components:
  - name: py-web
    container:
      image: registry.access.redhat.com/ubi9/python-39:1-172
      args: ["tail", "-f", "/dev/null"]
      mountSources: true
      volumeMounts:
        - name: cache
          path: /opt/app-root/src/
      endpoints:
        - name: jupyterlab
          targetPort: 8888
          exposure: public
  - name: cache
    volume:
      size: 1Gi
commands:
  - id: pip-install-requirements
    exec:
      commandLine: pip install -r requirements.txt
      workingDir: ${PROJECT_SOURCE}
      group:
        kind: build
        isDefault: true
      component: py-web
  - id: run-app
    exec:
      commandLine: 'jupyter lab --ip=0.0.0.0'
      workingDir: ${PROJECT_SOURCE}
      component: py-web
      group:
        kind: run
        isDefault: true
  - id: deploy
    composite:
      commands:
        - pip-install-requirements
        - run-app
      group:
        kind: deploy
        isDefault: true
